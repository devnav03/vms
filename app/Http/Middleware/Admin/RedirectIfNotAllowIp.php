<?phpnamespace App\Http\Middleware\Admin;use Closure;use Auth;class RedirectIfNotAllowIp {    /**     * Handle an incoming request.     *     * @param  \Illuminate\Http\Request  $request     * @param  \Closure  $next     * @return mixed     */    public function handle($request, Closure $next) {        $ipe=Auth::guard('admin')->user()->ip;        $ip=explode(',',$ipe);        //dd(Auth::guard('admin')->user()->company_id);        $cidata=$request->session()->get('CIDATA');        $cidata_ob=json_decode($cidata);    if(Auth::guard('admin')->user()->id == 1){        if(Auth::guard('admin')->user()->allowed_ip==1){            return $next($request);        }  elseif (in_array($request->ip(),$ip)) {            return $next($request);        } else{            Auth::guard('admin')->logout();            return redirect()->route('admin.login.form');        }    } else {        if(Auth::guard('admin')->user()->company_id == $cidata_ob->cid){        if(Auth::guard('admin')->user()->allowed_ip==1){            return $next($request);        }  elseif (in_array($request->ip(),$ip)) {            return $next($request);        } else{            Auth::guard('admin')->logout();            return redirect()->route('admin.login.form');        }    } else {            Auth::guard('admin')->logout();            return redirect()->route('admin.login.form');    }    }        }}